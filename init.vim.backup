" --- 基础设置 ---
syntax on                   " 语法高亮
set number                  " 显示行号
set relativenumber          " 相对行号
set cursorline              " 高亮当前行
set wrap                    " 自动折行
set showcmd                 " 显示输入的命令
set encoding=utf-8          " 使用 utf-8 编码
set laststatus=2            " 始终显示状态栏


" --- 缩进设置 ---
set tabstop=4               " Tab 宽度为 4
set shiftwidth=4            " 自动缩进宽度为 4
set expandtab               " 将 Tab 转换为空格
set autoindent              " 继承前一行的缩进

" --- 搜索设置 ---
set hlsearch                " 高亮搜索结果
set incsearch               " 边输入边跳转
set ignorecase              " 搜索忽略大小写
set smartcase               " 如果有大写字母则不忽略大小写

" --- 实用功能 ---
set scrolloff=5             " 距离顶部/底部 5 行时开始滚动
set backspace=indent,eol,start " 让退格键能删掉一切
set mouse=a                 " 启用鼠标

" --- 快捷映射 ---
let g:mapleader = "\<Space>"
let g:maplocalleader = ','
nmap <Leader>w :w<CR>|                   " 保存
nmap <Leader>q :q<CR>|                   " 关闭
nmap <Leader>l :nohlsearch<CR>|          " 清除搜索高亮
nnoremap <leader>e :NERDTreeToggle<CR>|  " 打开侧边栏
nnoremap <leader>ff :Files<CR>|          " 搜文件
nmap <leader>/ gcc|                      " 注释当前行
vmap <leader>/ gc|                       " 注释选中部分(选中模式)
nmap <leader>c <Plug>OSCYankOperator|    " 复制
nmap <leader>cc <leader>c_|              " 复制当前行
map <leader>c <Plug>OSCYankVisual|       " 复制（选中模式）
map <Enter> <Plug>(wildfire-fuel)

nnoremap <silent> <leader>      :<c-u>WhichKey '<Space>'<CR>
nnoremap <silent> <localleader> :<c-u>WhichKey  ','<CR>
nnoremap <silent> <leader>      :<c-u>WhichKey '<Space>'<CR>
nnoremap <silent> <localleader> :<c-u>WhichKey  ','<CR>

" --- Plugins ---
let data_dir = stdpath('data') . '/site'
if empty(glob(data_dir . '/autoload/plug.vim'))
  silent execute '!powershell -Command "iwr -useb https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim | ni \"'.data_dir.'/autoload/plug.vim\" -Force"'
  autocmd VimEnter * PlugInstall --sync | source $MYVIMRC
endif

call plug#begin()

" 基础套件
Plug 'tpope/vim-surround'             " 括号/引号处理
Plug 'tpope/vim-commentary'           " 快捷注释
Plug 'jiangmiao/auto-pairs'           " 自动括号
Plug 'jdhao/better-escape.vim'        " jk escape

" 搜索与跳转（Windows 需要单独安装 fzf）
Plug 'junegunn/fzf', { 'do': { -> fzf#install() } }
Plug 'junegunn/fzf.vim'

" 界面
Plug 'joshdick/onedark.vim'           " 主题
Plug 'itchyny/lightline.vim'          " 轻量状态栏
Plug 'airblade/vim-gitgutter'         " Git 状态显示
Plug 'preservim/nerdtree'             " 侧边栏
Plug 'liuchengxu/vim-which-key'       " 快捷键提示

" 实用功能
Plug 'ojroques/vim-oscyank', {'branch': 'main'}
Plug 'gcmt/wildfire.vim', {'branch': 'master'}      " 增量 text-object

call plug#end()

" --- 插件配置 ---
colorscheme onedark

" lightline 配置
let g:lightline = {
        \'colorscheme': 'onedark',
        \}

